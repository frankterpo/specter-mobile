# Mobile V1 API Endpoints - Complete Audit and Implementation Plan

## Current State Analysis

### Signal Feeds (READ) - ALL 9 WORKING

All signal feeds return 200 OK with valid JSON data:

| Feed | Endpoint | Status |
|------|----------|--------|
| Company | `POST /signals/company` | Working |
| People | `POST /signals/people` | Working |
| Talent | `POST /signals/talent` | Working |
| Investors | `POST /signals/investors` | Working |
| Revenue | `POST /signals/revenue` | Working |
| Strategic | `POST /signals/strategic` | Working |
| Funding Rounds | `POST /signals/funding-rounds` | Working |
| Acquisition | `POST /signals/acquisition` | Working |
| IPO | `POST /signals/ipo` | Working |

### Entity Status (WRITE) - 3 OF 9 WORKING

| Entity Type | Endpoint | Status | Notes |
|-------------|----------|--------|-------|
| People | `POST /entity-status/people/{id}` | Working | Returns null (success) |
| Company | `POST /entity-status/company/{id}` | Working | Singular path required |
| Investors | `POST /entity-status/investors/{id}` | Working | Plural path required |
| Talent | `POST /entity-status/talent/{id}` | **500 Error** | Backend not implemented |
| Revenue | `POST /entity-status/revenue/{id}` | **500 Error** | Backend not implemented |
| Strategic | `POST /entity-status/strategic/{id}` | **500 Error** | Backend not implemented |
| Funding Rounds | `POST /entity-status/funding-rounds/{id}` | **500 Error** | Backend not implemented |
| Acquisition | `POST /entity-status/acquisition/{id}` | **500 Error** | Backend not implemented |
| IPO | `POST /entity-status/ipo/{id}` | **500 Error** | Backend not implemented |

### Entity Status in Feed Responses

| Feed | Has `entity_status` field | Notes |
|------|---------------------------|-------|
| People | Yes | Shows current status |
| Talent | Yes | Shows current status |
| Strategic | Yes | Shows current status |
| Company | **No** | Missing from response |
| Investors | **No** | Missing from response |
| Revenue | **No** | Missing from response |
| Funding Rounds | **No** | Missing from response |
| Acquisition | **No** | Missing from response |
| IPO | **No** | Missing from response |

---

## Root Cause of Blockers

### 1. Entity Status Endpoints Return 500 for 6 Signal Types

The backend only has entity-status routes implemented for:

- `/entity-status/people/{id}`
- `/entity-status/company/{id}` (singular)
- `/entity-status/investors/{id}` (plural)

**Missing routes (return 500 "Unexpected Server Error"):**

- `/entity-status/talent/{id}`
- `/entity-status/revenue/{id}`
- `/entity-status/strategic/{id}`
- `/entity-status/funding-rounds/{id}`
- `/entity-status/acquisition/{id}`
- `/entity-status/ipo/{id}`

This is a **backend limitation** - the routes don't exist on the Specter backend.

### 2. Entity Status Not Returned in 6 Feed Types

When fetching signals, only 3 feeds include `entity_status` in responses:

- People, Talent, Strategic

**Missing `entity_status` field in:**

- Company, Investors, Revenue, Funding Rounds, Acquisition, IPO

This means even if you could set entity status, you couldn't verify it from the feed response.

---

## Implementation Plan

### Phase 1: Update Server.js with Working Endpoints Only

Update [`server.js`](server.js) to include only verified working endpoints:

**Working Entity Status Endpoints (3):**

```javascript
{ name: "Like Person", method: "POST", path: "/entity-status/people/{id}", body: { status: "liked" }, api: "app" },
{ name: "Like Company", method: "POST", path: "/entity-status/company/{id}", body: { status: "liked" }, api: "app" },
{ name: "Like Investor", method: "POST", path: "/entity-status/investors/{id}", body: { status: "liked" }, api: "app" },
```

**Add Missing Signal Feeds (6 not in current server.js):**

- Talent Signals
- Investor Signals
- Revenue Signals
- Strategic Signals
- Funding Rounds
- Acquisition
- IPO

### Phase 2: Workaround for Missing Entity Status

For the 6 signal types without native entity-status endpoints, implement a workaround:

**Option A: Map to Existing Endpoints**

- Talent signals contain person IDs -> use `/entity-status/people/{personId}`
- Revenue/Strategic/Funding/Acquisition/IPO signals contain company IDs -> use `/entity-status/company/{companyId}`

**Option B: Store Locally (Fallback)**

- Store entity status in local SQLite database
- Sync when backend support is added

### Phase 3: Update Plan Documentation

Update [`public_api_migration_mvp_a195a45d.plan.md`](/Users/franciscoterpolilli/.cursor/plans/public_api_migration_mvp_a195a45d.plan.md) with:

- Complete endpoint inventory
- Known blockers and workarounds
- Mobile V1 scope definition

---

## Mobile V1 Scope Definition

### Fully Supported Features (Ready Now)

1. **Browse all 9 signal feeds** - Working
2. **Like/Dislike/View for People** - Working
3. **Like/Dislike/View for Companies** - Working
4. **Like/Dislike/View for Investors** - Working
5. **View entity status for People, Talent, Strategic** - Working (returned in feed)

### Partially Supported (Workaround Needed)

1. **Entity status for Talent signals** - Use person ID with `/entity-status/people/{id}`
2. **Entity status for Revenue/Strategic/Funding/Acquisition/IPO** - Use company ID with `/entity-status/company/{id}`

### Not Supported (Backend Limitation)

1. **Native entity-status for Talent/Revenue/Strategic/Funding/Acquisition/IPO** - Returns 500
2. **Entity status visibility in Company/Investors/Revenue/Funding/Acquisition/IPO feeds** - Not included in response

---

## Files to Modify

| File | Changes |
|------|---------|
| [`server.js`](server.js) | Add 6 missing signal feeds, remove broken endpoints, add investor entity status |
| [`public_api_migration_mvp_a195a45d.plan.md`](/Users/franciscoterpolilli/.cursor/plans/public_api_migration_mvp_a195a45d.plan.md) | Update with complete endpoint inventory and blockers |

---

## Implementation Status

✅ **COMPLETE:** All phases implemented successfully

1. **Phase 1:** Server.js updated with all 9 signal feeds + 3 working entity-status endpoints
2. **Phase 2:** Entity status workaround mapping implemented (talent → people, others → company)
3. **Phase 3:** Plan documentation updated with complete inventory and Mobile V1 scope

**✅ VERIFICATION:** All 9 signal feeds and 3 entity-status endpoints confirmed working

## Recommended Next Steps

1. **Immediate:** Implement the entity status workaround in mobile app code
2. **Future:** Request backend team to add missing entity-status routes for talent/revenue/strategic/funding-rounds/acquisition/ipo
3. **Future:** Request backend team to include `entity_status` field in all feed responses
4. **Future:** Begin Mobile V1 development using the verified API endpoints

---

todos:
  - id: update-server-js-endpoints
    content: Update server.js to include only verified working endpoints (all 9 signal feeds + 3 working entity-status endpoints)
    status: completed
  - id: implement-entity-status-workaround
    content: Implement workaround mapping for entity status (talent to people endpoint, others to company endpoint)
    status: completed
  - id: update-plan-documentation
    content: Update plan documentation with complete endpoint inventory, known blockers, and Mobile V1 scope definition
    status: completed